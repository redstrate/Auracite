<!doctype html>
<html lang="en-US">
<head>
    <meta charset="utf-8" />
    <title>Auracite</title>
</head>
<body>
<script type="module">
    import init, {archive_character_base64} from "./pkg/auracite.js";

    function archive() {
        init().then(() => {
            archive_character_base64(document.getElementById("name").value, false).then((uri) => {
                // Download character archive
                window.location.replace(uri);
                document.getElementById("statusMessage").innerText = "Archive complete!";
            }).catch((err) => {
                document.getElementById("statusMessage").innerText = err;
            });
        });
    }

    document.querySelector('#downloadButton').addEventListener('click', archive);
</script>
<h1>Auracite</h1>
<p>This tool allows you to export your FFXIV character into portable, generic formats.</p>
<details>
    <p>Auracite uses the Lodestone for collecting data about your character. We use a proxy and that's unfortunately necessary, due to CORS compliance and Lodestone doing annoying browser compatibility checks we need to inject cookies for.</p>

    <p>The entire process happens locally, and does not give me any personally identifiable data about you. We only collect what is already publicly available on the Lodestone.</p>
    <summary>
        How does this work?
    </summary>
</details>
<details>
    <p>Here is the list of requests we make to the Lodestone:</p>
    <p>It makes <strong>one request</strong> to search for your character by it's name.</p>
    <p>It makes <strong>one request</strong> to request your character's main page. The other pages are not yet considered.</p>
    <p>It makes <strong>two requests</strong> to download images. This is currently your avatar and the full body portrait images.</p>

    <summary>
        What kind of requests does Auracite make?
    </summary>
</details>
<details>
    <p>Auracite can only collect as much data about your character as they make publicly available on the Lodestone.</p>
    <p>To work around this, I created a Dalamud plugin to collect even more information. It's available in my personal Dalamud plugin repository.</p>
    <p>The plugin needs to start a local HTTP server in order to communicate with Auracite. To prevent this from running all the time, you must type <code>/auracite begin</code> before clicking the "Download" button. Once the process is complete, the server is shutdown automatically. It's always safe to disable the plugin when you're not using Auracite.</p>
    <p>The website connects to your game client locally, and it does not use my server to proxy any data. No data leaves your device.</p>
    <summary>
        What is the "Connect to Dalamud Plugin" option?
    </summary>
</details>
<label for="name">Character Name:</label>
<input type="text" id="name" name="name" required minlength="4" maxlength="20" size="20" />
<input type="checkbox" id="scales" name="scales" />
<label for="scales">Connect to Dalamud Plugin</label>
<button class="favorite styled" type="button" id="downloadButton">Download</button>
<a href="https://github.com/redstrate/Auracite">Source Code</a>
<p id="statusMessage"></p>
</body>
</html>
